<!doctype html>
<html lang="pt-BR" class="dark">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Treinos + Timer</title>

<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0f172a">
<link rel="icon" href="icons/icon-192.png">

<script src="https://cdn.tailwindcss.com"></script>

<script>
tailwind.config = {
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        pinkshock: '#ff2d8d'
      }
    }
  }
}
</script>
</head>

<body class="bg-slate-950 text-slate-100 pb-20">

<div class="max-w-xl mx-auto p-4">

<!-- TELA CADASTRAR -->
<section id="telaCadastrar">
<h1 class="text-2xl font-semibold mb-6">Novo treino</h1>

<input id="inputNome"
  class="w-full rounded-xl bg-slate-900 border border-slate-800 px-3 py-2 mb-3"
  placeholder="Nome do treino" />

<textarea id="inputRaw"
  class="w-full rounded-xl bg-slate-900 border border-slate-800 px-3 py-2 min-h-[120px]"
  placeholder="Agachamento | 4x10 | descanso 90"></textarea>

<div class="flex gap-2 mt-3">
<button id="btnSalvar"
  class="flex-1 rounded-xl px-4 py-2 bg-pinkshock hover:opacity-90 font-medium">
Salvar
</button>
<button id="btnLimpar"
  class="rounded-xl px-4 py-2 bg-slate-800 hover:bg-slate-700">
Limpar
</button>
</div>

<div class="flex gap-2 mt-3">
<button id="btnExportar"
  class="flex-1 rounded-xl px-4 py-2 bg-slate-800 hover:bg-slate-700">
Exportar
</button>
<button id="btnImportar"
  class="flex-1 rounded-xl px-4 py-2 bg-slate-800 hover:bg-slate-700">
Importar
</button>
</div>

<input type="file" id="inputImport" accept="application/json" class="hidden">
</section>


<!-- TELA TREINOS -->
<section id="telaTreinos" class="hidden">
<h1 class="text-2xl font-semibold mb-6">Meus treinos</h1>
<div id="listaTreinos"></div>
</section>

</div>


<!-- MENU INFERIOR -->
<nav class="fixed bottom-0 left-0 right-0 bg-slate-900 border-t border-slate-800">
<div class="max-w-xl mx-auto flex">

<button id="navCadastrar"
  class="flex-1 py-3 text-center text-sm font-medium text-pinkshock">
âž• Cadastrar
</button>

<button id="navTreinos"
  class="flex-1 py-3 text-center text-sm font-medium text-slate-400">
ðŸ“‹ Treinos
</button>

</div>
</nav>


<script>
const KEY = "treinos_app_v3";

function getTreinos(){
  return JSON.parse(localStorage.getItem(KEY) || "[]");
}

function setTreinos(data){
  localStorage.setItem(KEY, JSON.stringify(data));
}

function parseLinhas(raw){
  return raw.split("\\n").filter(Boolean).map(l => {
    const partes = l.split("|").map(p => p.trim());
    return {
      nome: partes[0] || "ExercÃ­cio"
    }
  });
}

function renderLista(){
  const treinos = getTreinos();
  const host = document.getElementById("listaTreinos");
  host.innerHTML = "";

  if(!treinos.length){
    host.innerHTML = "<p class='text-slate-400'>Nenhum treino salvo.</p>";
    return;
  }

  treinos.forEach((t,i)=>{
    const div = document.createElement("div");
    div.className="border border-slate-800 bg-slate-900 rounded-xl p-3 mb-3";
    div.innerHTML = `
      <div class="flex justify-between items-center">
        <span>${t.nome}</span>
        <button onclick="excluir(${i})" class="text-xs text-pinkshock">Excluir</button>
      </div>
    `;
    host.appendChild(div);
  });
}

function excluir(i){
  const treinos = getTreinos();
  treinos.splice(i,1);
  setTreinos(treinos);
  renderLista();
}

document.getElementById("btnSalvar").onclick = () => {
  const nome = document.getElementById("inputNome").value;
  const raw = document.getElementById("inputRaw").value;

  if(!nome || !raw) return alert("Preencha os campos");

  const treinos = getTreinos();
  treinos.push({
    nome,
    exercicios: parseLinhas(raw)
  });

  setTreinos(treinos);
  renderLista();

  document.getElementById("inputNome").value="";
  document.getElementById("inputRaw").value="";
};

document.getElementById("btnLimpar").onclick = () => {
  if(confirm("Apagar todos os dados?")){
    localStorage.removeItem(KEY);
    renderLista();
  }
};

document.getElementById("btnExportar").onclick = () => {
  const dados = localStorage.getItem(KEY);
  if(!dados) return alert("Nada para exportar.");

  const blob = new Blob([dados], {type:"application/json"});
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "backup_treinos.json";
  a.click();

  URL.revokeObjectURL(url);
};

document.getElementById("btnImportar").onclick = () => {
  document.getElementById("inputImport").click();
};

document.getElementById("inputImport").addEventListener("change", function(){
  const file = this.files[0];
  if(!file) return;

  const reader = new FileReader();
  reader.onload = function(e){
    try{
      const dados = JSON.parse(e.target.result);
      localStorage.setItem(KEY, JSON.stringify(dados));
      renderLista();
      alert("Dados importados!");
    }catch{
      alert("Arquivo invÃ¡lido.");
    }
  };
  reader.readAsText(file);
});


// NAVEGAÃ‡ÃƒO
const telaCadastrar = document.getElementById("telaCadastrar");
const telaTreinos = document.getElementById("telaTreinos");

document.getElementById("navCadastrar").onclick = ()=>{
  telaCadastrar.classList.remove("hidden");
  telaTreinos.classList.add("hidden");

  navCadastrar.classList.add("text-pinkshock");
  navTreinos.classList.remove("text-pinkshock");
  navTreinos.classList.add("text-slate-400");
};

document.getElementById("navTreinos").onclick = ()=>{
  telaCadastrar.classList.add("hidden");
  telaTreinos.classList.remove("hidden");

  navTreinos.classList.add("text-pinkshock");
  navCadastrar.classList.remove("text-pinkshock");
  navCadastrar.classList.add("text-slate-400");
};

renderLista();
</script>

</body>
</html>
